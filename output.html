<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fitness Output</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body {
      background-color: #000;
      color: #fff;
      padding: 40px 20px;
      font-family: 'Segoe UI', sans-serif;
    }
    .card {
      background-color: #1c1c1c;
      border: none;
    }
    .btn-back {
      margin-top: 30px;
    }
    .section-title {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <div class="container text-center">
    <h1 class="display-4 fw-bold mb-4">üèãÔ∏è Fitness Results</h1>
    <p class="lead mb-5">Your personalized fitness insights are below.</p>
    <div id="exerciseResults" class="text-start"></div>
    <a href="post.html" class="btn btn-primary btn-back">‚Üê Back to Home</a>
  </div>

  <script>
    const apiKey = 'Uez4mfjEZ4cbE1WhzidmgQ==yxg4RAF2Yf9tJiMv';
    const params = new URLSearchParams(window.location.search);
    const muscle = params.get('muscle');
    const activity = params.get('activity');
    const plan = params.get('plan');
    const track = params.get('track');
    const resultsContainer = document.getElementById('exerciseResults');

    let hasData = false;

    // üí™ Strength Training
    if (muscle) {
      hasData = true;
      resultsContainer.innerHTML += `<p class="text-info">Loading exercises for <strong>${muscle}</strong>...</p>`;
      fetch(`https://api.api-ninjas.com/v1/exercises?muscle=${encodeURIComponent(muscle)}`, {
        method: 'GET',
        headers: { 'X-Api-Key': apiKey }
      })
      .then(response => response.json())
      .then(data => {
        if (!Array.isArray(data) || data.length === 0) {
          resultsContainer.innerHTML += `<p class="text-warning">No exercises found for "${muscle}".</p>`;
          return;
        }
        let html = `<h3 class="text-white mb-4">üí™ Strength Exercises for ${muscle}</h3>`;
        data.forEach(exercise => {
          html += `
            <div class="card bg-dark text-white mb-3">
              <div class="card-body">
                <h5 class="card-title">${exercise.name || 'N/A'}</h5>
                <p><strong>Type:</strong> ${exercise.type || 'N/A'}</p>
                <p><strong>Difficulty:</strong> ${exercise.difficulty || 'N/A'}</p>
                <p><strong>Instructions:</strong> ${exercise.instructions || 'N/A'}</p>
              </div>
            </div>`;
        });
        resultsContainer.innerHTML += html;
      })
      .catch(error => {
        resultsContainer.innerHTML += `<p class="text-danger">Error fetching exercises: ${error.message}</p>`;
      });
    }

    // üî• Fat Loss
    if (activity) {
      hasData = true;
      resultsContainer.innerHTML += `<p class="text-info">Loading calorie burn data for <strong>${activity}</strong>...</p>`;
      fetch(`https://api.api-ninjas.com/v1/caloriesburned?activity=${encodeURIComponent(activity)}`, {
        method: 'GET',
        headers: { 'X-Api-Key': apiKey }
      })
      .then(response => response.json())
      .then(data => {
        if (!Array.isArray(data) || data.length === 0) {
          resultsContainer.innerHTML += `<p class="text-warning">No calorie data found for "${activity}".</p>`;
          return;
        }
        let html = `<h3 class="text-white mb-4">üî• Calories Burned for ${activity}</h3>`;
        data.forEach(entry => {
          html += `
            <div class="card bg-dark text-white mb-3">
              <div class="card-body">
                <h5 class="card-title">${entry.name || 'N/A'}</h5>
                <p><strong>Duration:</strong> ${entry.duration_minutes || 'N/A'} minutes</p>
                <p><strong>Calories Burned:</strong> ${entry.total_calories || 'N/A'} kcal</p>
              </div>
            </div>`;
        });
        resultsContainer.innerHTML += html;
      })
      .catch(error => {
        resultsContainer.innerHTML += `<p class="text-danger">Error fetching calorie data: ${error.message}</p>`;
      });
    }

// üìã Workout Plan
if (plan && typeof plan === 'string') {
  hasData = true;

  const rawData = localStorage.getItem('workoutPlanData');
  let workoutPlan;

  try {
    workoutPlan = JSON.parse(rawData);
  } catch (e) {
    console.error('Invalid JSON in workoutPlanData:', e);
    workoutPlan = null;
  }

  if (workoutPlan && Array.isArray(workoutPlan) && workoutPlan.length > 0) {
    let html = `<h3 class="text-white mb-4">üìã Workout Plan for ${plan}</h3>`;
    workoutPlan.forEach(ex => {
      html += `
        <div class="card bg-dark text-white mb-3">
          <div class="card-body">
            <h5 class="card-title">${ex.name || 'Unnamed Exercise'}</h5>
            <p><strong>Sets:</strong> ${ex.sets || '-'}</p>
            <p><strong>Reps:</strong> ${ex.reps || '-'}</p>
          </div>
        </div>`;
    });

    if (resultsContainer && resultsContainer.innerHTML !== undefined) {
      resultsContainer.innerHTML += html;
    } else {
      console.error('resultsContainer is not defined or invalid.');
    }
  } else {
    if (resultsContainer && resultsContainer.innerHTML !== undefined) {
      resultsContainer.innerHTML += `<p class="text-warning">No workout plan data found for "${plan}".</p>`;
    } else {
      console.error('resultsContainer is not defined or invalid.');
    }
  }
}
    // üìä Calorie Calculator
    if (track === 'calories') {
      hasData = true;
      const data = JSON.parse(localStorage.getItem('calorieTrackingData'));
      if (data) {
        resultsContainer.innerHTML += `
          <h3 class="text-white mb-4">üìä Calorie Tracking Results</h3>
          <div class="card bg-dark text-white mb-3">
            <div class="card-body">
              <p><strong>Weight:</strong> ${data.weight} kg</p>
              <p><strong>Height:</strong> ${data.height} cm</p>
              <p><strong>Age:</strong> ${data.age} years</p>
              <p><strong>Sex:</strong> ${data.sex}</p>
              <p><strong>Activity Level:</strong> ${data.activityLevel}</p>
              <hr>
              <p><strong>Maintenance Calories:</strong> ${data.maintenance} kcal/day</p>
              <p><strong>Weight Loss Calories:</strong> ${data.loss} kcal/day</p>
              <p><strong>Weight Gain Calories:</strong> ${data.gain} kcal/day</p>
            </div>
          </div>
        `;
      } else {
        resultsContainer.innerHTML += `<p class="text-warning">No calorie tracking data found.</p>`;
      }
    }

    // Default fallback
    if (!hasData) {
      resultsContainer.innerHTML = `<p class="text-warning">No fitness data provided. Please return to the home page and try again.</p>`;
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>